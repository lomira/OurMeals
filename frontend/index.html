<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>OurMeals - Planificateur de repas et de courses</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Minimalist styling -->
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header>
      <h1>OurMeals</h1>
      <p class="subtitle">
        Recettes simples, plan de repas hebdomadaire et liste de courses
      </p>
    </header>

    <nav class="tabbar" role="tablist" aria-label="Navigation">
      <button
        id="tab-plan"
        role="tab"
        aria-controls="section-plan"
        aria-selected="true"
      >
        Plan
      </button>
      <button
        id="tab-courses"
        role="tab"
        aria-controls="section-grocery"
        aria-selected="false"
      >
        Courses
      </button>
      <button
        id="tab-recettes"
        role="tab"
        aria-controls="section-recipes"
        aria-selected="false"
      >
        Recettes
      </button>
    </nav>

    <main>
      <!-- Weekly Meal Plan (1st panel) -->
      <section
        id="section-plan"
        class="card"
        role="tabpanel"
        aria-labelledby="tab-plan"
      >
        <h2>Plan de repas hebdomadaire</h2>
        <div class="table-wrapper">
          <table id="meal-plan-table">
            <thead>
              <tr>
                <th>Jour</th>
                <th>Petit-déjeuner</th>
                <th>Déjeuner</th>
                <th>Dîner</th>
              </tr>
            </thead>
            <tbody id="meal-plan-body">
              <!-- Rows for Monday-Sunday rendered by script.js -->
            </tbody>
          </table>
        </div>
        <p class="hint">
          Sélectionner une recette dans une cellule l’assigne à cet emplacement.
          Changer la sélection désassignera la recette précédente.
        </p>
      </section>

      <!-- Grocery List (2nd panel) -->
      <section
        id="section-grocery"
        class="card"
        role="tabpanel"
        aria-labelledby="tab-courses"
      >
        <h2>Liste de courses</h2>
        <div class="form-actions">
          <label
            for="grocery-start-date"
            class="muted"
            style="margin-right: 8px"
            >À partir du</label
          >
          <input type="date" id="grocery-start-date" />
          <button id="generate-grocery">Générer la liste de courses</button>
        </div>
        <ul id="grocery-list" class="list"></ul>
      </section>

      <!-- Recipes (3rd panel) -->
      <section
        id="section-recipes"
        class="card"
        role="tabpanel"
        aria-labelledby="tab-recettes"
      >
        <h2>Recettes</h2>

        <!-- Collapsible form drawer -->
        <details id="recipe-drawer">
          <summary>Ajouter / Modifier une recette</summary>

          <form id="recipe-form">
            <div class="form-row">
              <label for="recipe-name">Nom</label>
              <input
                type="text"
                id="recipe-name"
                name="name"
                placeholder="ex. Spaghettis bolognaise"
                required
              />
            </div>

            <div class="form-row">
              <label for="recipe-servings">Portions</label>
              <input
                type="number"
                id="recipe-servings"
                name="baseServings"
                min="1"
                value="1"
              />
            </div>

            <div class="form-row">
              <label for="recipe-ingredients"
                >Ingrédients (un par ligne ou séparés par des virgules)</label
              >
              <textarea
                id="recipe-ingredients"
                name="ingredients"
                rows="5"
                placeholder="boeuf haché
oignon
sauce tomate
spaghettis"
                required
              ></textarea>
            </div>

            <div class="form-actions">
              <button type="submit" id="save-recipe">
                Enregistrer la recette
              </button>
              <button type="button" id="cancel-edit" class="secondary" hidden>
                Annuler la modification
              </button>
            </div>

            <p class="hint">
              Astuce&nbsp;: Vous pouvez coller les ingrédients ligne par ligne
              ou séparés par des virgules. L’application les normalisera.
            </p>
            <p class="hint" id="edit-warning" hidden>
              La modification recrée la recette (pas d’endpoint de mise à jour),
              donc toute affectation dans le plan de repas pour l’ancienne
              recette sera supprimée.
            </p>
          </form>
        </details>

        <!-- Recipes List -->
        <ul id="recipes-list" class="list"></ul>
      </section>
    </main>

    <footer>
      <p>
        L’API backend doit être en cours d’exécution. En local, la valeur par
        défaut est http://localhost:5000. Sur Render, définissez API_BASE dans
        script.js.
      </p>
    </footer>

    <!-- Using same-origin API on Render; leave API_BASE unset -->
    <!-- App logic -->
    <script src="script.js"></script>
  </body>
</html>
